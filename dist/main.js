document.getElementById("save_button").addEventListener("click",p);document.getElementById("check_button").addEventListener("click",d);function p(){const e=document.form,t=e.deepl_api_type.value,a=e.deepl_auth.value,n=e.deepl_target.value;chrome.storage.local.set({api_type:t,deepl_auth:a,deepl_target:n},function(){const o=document.getElementById("message_text");o.textContent="Saved!"})}const l={free:"https://api-free.deepl.com/v2/usage",pro:"https://api.deepl.com/v2/usage"};async function d(){const e=document.form,t=e.deepl_api_type.value,a=e.deepl_auth.value;if(!t||!a)return;let n=new FormData;n.append("auth_key",a);const o=await fetch(l[t],{method:"post",body:n}).then(c=>{if(c.status===403)throw new Error("Authentication failure");return c.json()});document.getElementById("deepl_usage").textContent=` Deepl API Usage: ${o.character_count} / ${o.character_limit}`}async function u(){var a,n,o;const e=await chrome.storage.local.get(["api_type","deepl_auth","deepl_target"]),t=document.form;t.deepl_api_type.value=(a=e.api_type)!=null?a:"free",t.deepl_auth.value=(n=e.deepl_auth)!=null?n:"",t.deepl_target.value=(o=e.deepl_target)!=null?o:""}u();
